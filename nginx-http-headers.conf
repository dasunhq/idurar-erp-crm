##
# HTTP Security Headers
##

# Content Security Policy (CSP)
map $sent_http_content_type $csp_value {
    default "default-src 'self'; script-src 'self' 'nonce-{{NONCE}}' 'unsafe-inline'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; img-src 'self' data: https://cdn.example.com; font-src 'self' https://fonts.googleapis.com https://fonts.gstatic.com; connect-src 'self' http://backend:8888; frame-src 'self'; frame-ancestors 'none'; object-src 'none'; base-uri 'self'; form-action 'self'; manifest-src 'self'; media-src 'self'; worker-src 'self'; upgrade-insecure-requests;";
    "~text/html" "default-src 'self'; script-src 'self' 'nonce-{{NONCE}}' 'unsafe-inline'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; img-src 'self' data: https://cdn.example.com; font-src 'self' https://fonts.googleapis.com https://fonts.gstatic.com; connect-src 'self' http://backend:8888; frame-src 'self'; frame-ancestors 'none'; object-src 'none'; base-uri 'self'; form-action 'self'; manifest-src 'self'; media-src 'self'; worker-src 'self'; upgrade-insecure-requests;";
}